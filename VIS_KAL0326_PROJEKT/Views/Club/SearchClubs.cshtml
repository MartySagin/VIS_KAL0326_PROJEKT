@{
    ViewData["Title"] = "Vyhledat Kluby";

    var clubs = ViewBag.Clubs as IEnumerable<DataAccess.Models.Club>;
}

<div class="container mt-5">
    <h2 class="text-center">Vyhledat Kluby</h2>

    <form method="post" asp-controller="Club" asp-action="SearchClubs" class="bg-light p-4 rounded shadow-sm">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="name" class="form-label">Název</label>
                <input type="text" id="name" name="name" class="form-control" maxlength="100" placeholder="Zadejte název klubu" />
            </div>
            <div class="col-md-6 mb-3">
                <label for="address" class="form-label">Adresa</label>
                <input type="text" id="address" name="address" class="form-control" maxlength="100" placeholder="Zadejte adresu" />
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="type" class="form-label">Typ</label>
                <input type="text" id="type" name="type" class="form-control" maxlength="50" placeholder="Zadejte typ klubu" />
            </div>
            <div class="col-md-6 mb-3">
                <label for="capacity" class="form-label">Kapacita</label>
                <input type="number" id="capacity" name="capacity" class="form-control" min="1" max="1000" placeholder="Minimální kapacita" />
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="priceFrom" class="form-label">Cena od</label>
                <input type="number" id="priceFrom" name="priceFrom" class="form-control" min="0" placeholder="Minimální cena" />
            </div>
            <div class="col-md-6 mb-3">
                <label for="priceTo" class="form-label">Cena do</label>
                <input type="number" id="priceTo" name="priceTo" class="form-control" min="0" placeholder="Maximální cena" />
            </div>
        </div>

        <div class="mb-3">
            <label for="reservationDate" class="form-label">Datum rezervace <span class="text-danger">*</span></label>
            <input type="date" id="reservationDate" name="reservationDate" class="form-control" required
                   min="@DateTime.Now.ToString("yyyy-MM-dd")" />
        </div>

        <button type="submit" class="btn btn-primary w-100">Hledat</button>
    </form>

    @if (clubs != null && clubs.Any())
    {
        <h3 class="mt-5 text-center">Výsledky hledání (@clubs.Count())</h3>

        <table class="table table-striped mt-3 shadow-sm">
            <thead class="table-dark">
                <tr>
                    <th>Název</th>
                    <th>Adresa</th>
                    <th>Typ</th>
                    <th>Kapacita</th>
                    <th>Cena za osobu</th>
                    <th>Rezervovat</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var club in clubs)
                {
                    <tr>
                        <td>@club.Name</td>
                        <td>@club.Address</td>
                        <td>@club.Type</td>
                        <td>@club.Capacity 🧑</td>
                        <td>@club.Price Kč za osobu</td>
                        <td>
                            @if (ViewBag.IsLoggedIn ?? false)
                            {
                                <form method="post" asp-controller="Reservation" asp-action="ReviewReservation" class="d-inline">
                                    <input type="hidden" name="ClubId" value="@club.ClubId" />
                                    <input type="hidden" name="UserId" value="@ViewBag.UserId" />
                                    <input type="hidden" name="ReservationDate" value="@Context.Request.Form["reservationDate"]" />
                                    <button type="submit" class="btn btn-success btn-sm">Rezervovat</button>
                                </form>
                            }
                            else
                            {
                                <span class="text-danger">Nejste přihlášen</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (clubs != null)
    {
        <p class="text-warning text-center mt-4">Nebyly nalezeny žádné kluby odpovídající kritériím.</p>
    }
</div>
